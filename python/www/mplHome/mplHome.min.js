var socket;function setupWebsockets(){var n="ws://"+document.location.hostname+":"+document.location.port+"/ws";console.log(n),socket=new WebSocket(n),console.log("socket status: "+socket.readyState),socket?(socket.onmessage=function(n){value=n.data,console.log("[onStringMessage] new message received ",value);var t=value.indexOf(":");routeMessage(value.slice(0,t),value.slice(t+1))},socket.onclose=function(){console.log("The connection has been closed."),socket.close}):console.log("invalid socket"),setupCallbacks()}function sendCmd(n){console.log("SEND:"+n),socket.send(n)}function routeMessage(n,t){if("strStatus"==n&&($("#msg_status").html(t),$("#msg_status_opt").html(t),$("#msg_status_myo").html(t)),"strTrainingMotion"==n&&$("#msg_train").text(t),"strOutputMotion"==n&&($("#main_output").text(t),$("#mt_output").text(t),$("#tac_output").text(t)),"strMotionTester"==n&&$("#mt_status").text(t),"strMotionTesterProgress"==n&&updateMTProgressBar(t),"strMotionTesterImage"==n&&updateMTImage(t),"strTAC"==n&&$("#tac_status").text(t),"strTACJoint1Name"==n&&$("#tacJoint1Name").text(t),"strTACJoint1Bar"==n&&updateTACJointBar(t,"tacJoint1Bar","tacJoint1Label"),"strTACJoint1Target"==n&&updateTACJointTarget(t,"tacJoint1Target"),"strTACJoint1Error"==n&&updateTACJointError(t,"tacJoint1Target"),"strTACJoint2Name"==n&&$("#tacJoint2Name").text(t),"strTACJoint2Bar"==n&&updateTACJointBar(t,"tacJoint2Bar","tacJoint2Label"),"strTACJoint2Target"==n&&updateTACJointTarget(t,"tacJoint2Target"),"strTACJoint2Error"==n&&updateTACJointError(t,"tacJoint2Target"),"strTACJoint3Name"==n&&$("#tacJoint3Name").text(t),"strTACJoint3Bar"==n&&updateTACJointBar(t,"tacJoint3Bar","tacJoint3Label"),"strTACJoint3Target"==n&&updateTACJointTarget(t,"tacJoint3Target"),"strTACJoint3Error"==n&&updateTACJointError(t,"tacJoint3Target"),"jointCmd"==n){var e=t.split(",");$("#SHFE_Cmd").html(e[0]),$("#SHAA_Cmd").html(e[1]),$("#HUM_Cmd").html(e[2]),$("#EL_Cmd").html(e[3]),$("#WRT_Cmd").html(e[4]),$("#WAA_Cmd").html(e[5]),$("#WFE_Cmd").html(e[6]),$("#1AA_Cmd").html(e[7]),$("#1MCP_Cmd").html(e[8]),$("#1PIP_Cmd").html(e[9]),$("#1DIP_Cmd").html(e[10]),$("#2AA_Cmd").html(e[11]),$("#2MCP_Cmd").html(e[12]),$("#2PIP_Cmd").html(e[13]),$("#2DIP_Cmd").html(e[14]),$("#3AA_Cmd").html(e[15]),$("#3MCP_Cmd").html(e[16]),$("#3PIP_Cmd").html(e[17]),$("#3DIP_Cmd").html(e[18]),$("#4AA_Cmd").html(e[19]),$("#4MCP_Cmd").html(e[20]),$("#4PIP_Cmd").html(e[21]),$("#4DIP_Cmd").html(e[22]),$("#5AA_Cmd").html(e[23]),$("#5CMC_Cmd").html(e[24]),$("#5MCP_Cmd").html(e[25]),$("#5DIP_Cmd").html(e[26])}if("jointPos"==n){e=t.split(",");$("#SHFE_Pos").html(e[0]),$("#SHAA_Pos").html(e[1]),$("#HUM_Pos").html(e[2]),$("#EL_Pos").html(e[3]),$("#WRT_Pos").html(e[4]),$("#WAA_Pos").html(e[5]),$("#WFE_Pos").html(e[6]),$("#1AA_Pos").html(e[7]),$("#1MCP_Pos").html(e[8]),$("#1PIP_Pos").html(e[9]),$("#1DIP_Pos").html(e[10]),$("#2AA_Pos").html(e[11]),$("#2MCP_Pos").html(e[12]),$("#2PIP_Pos").html(e[13]),$("#2DIP_Pos").html(e[14]),$("#3AA_Pos").html(e[15]),$("#3MCP_Pos").html(e[16]),$("#3PIP_Pos").html(e[17]),$("#3DIP_Pos").html(e[18]),$("#4AA_Pos").html(e[19]),$("#4MCP_Pos").html(e[20]),$("#4PIP_Pos").html(e[21]),$("#4DIP_Pos").html(e[22]),$("#5AA_Pos").html(e[23]),$("#5CMC_Pos").html(e[24]),$("#5MCP_Pos").html(e[25]),$("#5DIP_Pos").html(e[26])}if("jointTorque"==n){e=t.split(",");$("#SHFE_Torque").html(e[0]),$("#SHAA_Torque").html(e[1]),$("#HUM_Torque").html(e[2]),$("#EL_Torque").html(e[3]),$("#WRT_Torque").html(e[4]),$("#WAA_Torque").html(e[5]),$("#WFE_Torque").html(e[6]),$("#1AA_Torque").html(e[7]),$("#1MCP_Torque").html(e[8]),$("#1PIP_Torque").html(e[9]),$("#1DIP_Torque").html(e[10]),$("#2AA_Torque").html(e[11]),$("#2MCP_Torque").html(e[12]),$("#2PIP_Torque").html(e[13]),$("#2DIP_Torque").html(e[14]),$("#3AA_Torque").html(e[15]),$("#3MCP_Torque").html(e[16]),$("#3PIP_Torque").html(e[17]),$("#3DIP_Torque").html(e[18]),$("#4AA_Torque").html(e[19]),$("#4MCP_Torque").html(e[20]),$("#4PIP_Torque").html(e[21]),$("#4DIP_Torque").html(e[22]),$("#5AA_Torque").html(e[23]),$("#5CMC_Torque").html(e[24]),$("#5MCP_Torque").html(e[25]),$("#5DIP_Torque").html(e[26])}if("jointTemp"==n){e=t.split(",");$("#SHFE_Temp").html(e[0]),$("#SHAA_Temp").html(e[1]),$("#HUM_Temp").html(e[2]),$("#EL_Temp").html(e[3]),$("#WRT_Temp").html(e[4]),$("#WAA_Temp").html(e[5]),$("#WFE_Temp").html(e[6]),$("#1AA_Temp").html(e[7]),$("#1MCP_Temp").html(e[8]),$("#1PIP_Temp").html(e[9]),$("#1DIP_Temp").html(e[10]),$("#2AA_Temp").html(e[11]),$("#2MCP_Temp").html(e[12]),$("#2PIP_Temp").html(e[13]),$("#2DIP_Temp").html(e[14]),$("#3AA_Temp").html(e[15]),$("#3MCP_Temp").html(e[16]),$("#3PIP_Temp").html(e[17]),$("#3DIP_Temp").html(e[18]),$("#4AA_Temp").html(e[19]),$("#4MCP_Temp").html(e[20]),$("#4PIP_Temp").html(e[21]),$("#4DIP_Temp").html(e[22]),$("#5AA_Temp").html(e[23]),$("#5CMC_Temp").html(e[24]),$("#5MCP_Temp").html(e[25]),$("#5DIP_Temp").html(e[26])}}function setupCallbacks(){$("#ID_CLEARCLASS").on("mousedown",function(){sendCmd("Cmd:ClearClass")}),$("#ID_CLEARALL").on("mousedown",function(){sendCmd("Cmd:ClearAll")}),$("#ID_TRAIN").on("mousedown",function(){sendCmd("Cmd:Train")}),$("#ID_SAVE").on("mousedown",function(){sendCmd("Cmd:Save")}),$("#ID_BACKUP").on("mousedown",function(){sendCmd("Cmd:Backup")}),$("#ID_SPEEDUP").on("mousedown",function(){sendCmd("Cmd:SpeedUp")}),$("#ID_SPEEDDOWN").on("mousedown",function(){sendCmd("Cmd:SpeedDown")}),$("#ID_HAND_SPEED_UP").on("mousedown",function(){sendCmd("Cmd:HandSpeedUp")}),$("#ID_HAND_SPEED_DOWN").on("mousedown",function(){sendCmd("Cmd:HandSpeedDown")}),$("#ID_MYO1").on("mousedown",function(){sendCmd("Cmd:RestartMyo1")}),$("#ID_MYO2").on("mousedown",function(){sendCmd("Cmd:RestartMyo2")}),$("#ID_SELECT_MYO_SET_1").on("mousedown",function(){sendCmd("Cmd:ChangeMyoSet1")}),$("#ID_SELECT_MYO_SET_2").on("mousedown",function(){sendCmd("Cmd:ChangeMyoSet2")}),$("#ID_RELOAD_ROC").on("mousedown",function(){sendCmd("Cmd:ReloadRoc")}),$("#ID_REBOOT").on("mousedown",function(){sendCmd("Cmd:Reboot")}),$("#ID_SHUTDOWN").on("mousedown",function(){sendCmd("Cmd:Shutdown")}),$("#ID_ASSESSMENT_MT").on("mousedown",function(){startMT()}),$("#ID_ASSESSMENT_MT_STOP").on("mousedown",function(){stopMT()}),$("#ID_ASSESSMENT_TAC1").on("mousedown",function(){startTAC1()}),$("#ID_ASSESSMENT_TAC3").on("mousedown",function(){startTAC3()}),$("#ID_ASSESSMENT_TAC_STOP").on("mousedown",function(){stopTAC()}),$("#ID_GOTO_HOME").on("mousedown",function(){sendCmd("Cmd:GotoHome")}),$("#ID_GOTO_PARK").on("mousedown",function(){sendCmd("Cmd:GotoPark")}),$("#MAN_ElbowFlex").on("mousedown",function(){sendCmd("Man:Elbow Flexion")}),$("#MAN_ElbowExtend").on("mousedown",function(){sendCmd("Man:Elbow Extension")}),$("#MAN_Pronate").on("mousedown",function(){sendCmd("Man:Wrist Rotate In")}),$("#MAN_Supinate").on("mousedown",function(){sendCmd("Man:Wrist Rotate Out")}),$("#MAN_WristFlex").on("mousedown",function(){sendCmd("Man:Wrist Flex In")}),$("#MAN_WristExtend").on("mousedown",function(){sendCmd("Man:Wrist Extend Out")}),$("#MAN_HandOpen1").on("mousedown",function(){sendCmd("Man:Hand Open")}),$("#MAN_HandOpen2").on("mousedown",function(){sendCmd("Man:Hand Open")}),$("#MAN_Spherical").on("mousedown",function(){sendCmd("Man:Spherical Grasp")}),$("#MAN_Tip").on("mousedown",function(){sendCmd("Man:Tip Grasp")}),$("#MAN_ThreeFingerPinch").on("mousedown",function(){sendCmd("Man:Three Finger Pinch Grasp")}),$("#MAN_Lateral").on("mousedown",function(){sendCmd("Man:Lateral Grasp")}),$("#MAN_Cylindrical").on("mousedown",function(){sendCmd("Man:Cylindrical Grasp")}),$("#MAN_Point").on("mousedown",function(){sendCmd("Man:Point Grasp")}),$("#MAN_Index").on("mousedown",function(){sendCmd("Man:Index")}),$("#MAN_Middle").on("mousedown",function(){sendCmd("Man:Middle")}),$("#MAN_Ring").on("mousedown",function(){sendCmd("Man:Ring")}),$("#MAN_Little").on("mousedown",function(){sendCmd("Man:Little")}),$("#MAN_Thumb").on("mousedown",function(){sendCmd("Man:Thumb")}),$("#MAN_RingMiddle").on("mousedown",function(){sendCmd("Man:Ring-Middle")}),$("#MAN_TheBird").on("mousedown",function(){sendCmd("Man:The Bird")}),$("#MAN_Stop1").on("mousedown",function(){sendCmd("Man:Stop")}),$("#MAN_Stop2").on("mousedown",function(){sendCmd("Man:Stop")}),$("#trainSwitch").on("change",function(){!0===this.checked?sendCmd("Cmd:Add"):sendCmd("Cmd:Stop")}),$("#precisionMode").on("change",function(){!0===this.checked?sendCmd("Cmd:PrecisionModeOn"):sendCmd("Cmd:PrecisionModeOff")}),$("#pauseAll").on("change",function(){!0===this.checked?sendCmd("Cmd:PauseAllOn"):sendCmd("Cmd:PauseAllOff")}),$("#pauseHand").on("change",function(){!0===this.checked?sendCmd("Cmd:PauseHandOn"):sendCmd("Cmd:PauseHandOff")}),$("#resetTorque").on("change",function(){"On"==this.value?sendCmd("Cmd:ResetTorqueOn"):sendCmd("Cmd:ResetTorqueOff")}),$("#enableImpedance").on("change",function(){"On"==this.value?sendCmd("Cmd:ImpedanceOn"):sendCmd("Cmd:ImpedanceOff")}),$("#impedanceLevel").on("change",function(){"Low"==this.value?sendCmd("Cmd:ImpedanceLow"):sendCmd("Cmd:ImpedanceHigh")}),$("#autoSave").on("change",function(){"On"==this.value?sendCmd("Cmd:AutoSaveOn"):sendCmd("Cmd:AutoSaveOff")}),$("#autoOpen").on("change",function(){"On"==this.value?sendCmd("Cmd:AutoOpenOn"):sendCmd("Cmd:AutoOpenOff")}),$("#manualControl").on("change",function(){"On"==this.value?sendCmd("Cmd:ManualControlOn"):sendCmd("Cmd:ManualControlOff")}),$("#streamPercepts").on("change",function(){"On"==this.value?sendCmd("Cmd:JointPerceptsOn"):sendCmd("Cmd:JointPerceptsOff")})}function submitLogMessage(){var n=document.getElementById("ID_LOG_MSG").value;console.log("Logging "+n),sendCmd("Log:"+n)}function startMT(){sendCmd("Cmd:StartMotionTester-"+$("#ID_MT_REPETITIONS").val()+"-"+$("#ID_MT_TIMEOUT").val()+"-"+$("#ID_MT_MAX_CLASSIFICATIONS").val())}function stopMT(){sendCmd("Cmd:StopMotionTester")}function startTAC1(){sendCmd("Cmd:StartTAC1-"+$("#ID_REPETITIONS").val()+"-"+$("#ID_TIMEOUT").val()+"-"+$("#ID_DWELL_TIME").val()+"-"+$("#ID_DEGREE_ERROR").val()+"-"+$("#ID_GRASP_ERROR").val())}function startTAC3(){sendCmd("Cmd:StartTAC3-"+$("#ID_REPETITIONS").val()+"-"+$("#ID_TIMEOUT").val()+"-"+$("#ID_DWELL_TIME").val()+"-"+$("#ID_DEGREE_ERROR").val()+"-"+$("#ID_GRASP_ERROR").val())}function stopTAC(){sendCmd("Cmd:StopTAC")}function updateMTProgressBar(n){document.getElementById("mtProgressBar").style.width=n+"%",document.getElementById("mtProgressLabel").innerHTML=1*n+"%"}function updateMTImage(n){document.getElementById("ID_MT_IMAGE").src=n}function updateTACJointBar(n,t,e){document.getElementById(t).style.marginLeft=n-2.5+"%",document.getElementById(e).innerHTML=Math.round(1*n)}function updateTACJointError(n,t){document.getElementById(t).style.width=2*n+"%"}function updateTACJointTarget(n,t){var e=document.getElementById(t);percentChar=e.style.width,percentNum=percentChar.substring(0,percentChar.length-1),halfWidth=1*percentNum/2,valuePercent=1*n,newMargin=valuePercent-halfWidth,newMarginPercent=1*newMargin+"%",e.style.marginLeft=newMarginPercent}jQuery(function(n){"WebSocket"in window?setupWebsockets():alert("Your browser does not support web sockets");setInterval(function(){"up"===Offline.state&&Offline.check()},3e3),Offline.on("up",setupWebsockets)});