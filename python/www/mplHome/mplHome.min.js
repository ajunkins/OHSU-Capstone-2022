function setupWebsockets(){var t="ws://"+document.location.hostname+":"+document.location.port+"/ws";console.log(t),socket=new WebSocket(t),console.log("socket status: "+socket.readyState),socket?(socket.onmessage=function(t){value=t.data,console.log("[onStringMessage] new message received ",value);var e=value.indexOf(":");routeMessage(value.slice(0,e),value.slice(e+1))},socket.onclose=function(){console.log("The connection has been closed."),socket.close}):console.log("invalid socket"),setupCallbacks()}function sendCmd(t){console.log("SEND:"+t),socket.send(t)}function routeMessage(t,e){"strStatus"==t&&($("#msg_status").html(e),$("#msg_status_opt").html(e),$("#msg_status_myo").html(e)),"strTrainingMotion"==t&&$("#msg_train").text(e),"strOutputMotion"==t&&($("#main_output").text(e),$("#mt_output").text(e),$("#tac_output").text(e)),"strMotionTester"==t&&$("#mt_status").text(e),"strMotionTesterProgress"==t&&updateMTProgressBar(e),"strMotionTesterImage"==t&&updateMTImage(e),"strTAC"==t&&$("#tac_status").text(e),"strTACJoint1Name"==t&&$("#tacJoint1Name").text(e),"strTACJoint1Bar"==t&&updateTACJointBar(e,"tacJoint1Bar","tacJoint1Label"),"strTACJoint1Target"==t&&updateTACJointTarget(e,"tacJoint1Target"),"strTACJoint1Error"==t&&updateTACJointError(e,"tacJoint1Target"),"strTACJoint2Name"==t&&$("#tacJoint2Name").text(e),"strTACJoint2Bar"==t&&updateTACJointBar(e,"tacJoint2Bar","tacJoint2Label"),"strTACJoint2Target"==t&&updateTACJointTarget(e,"tacJoint2Target"),"strTACJoint2Error"==t&&updateTACJointError(e,"tacJoint2Target"),"strTACJoint3Name"==t&&$("#tacJoint3Name").text(e),"strTACJoint3Bar"==t&&updateTACJointBar(e,"tacJoint3Bar","tacJoint3Label"),"strTACJoint3Target"==t&&updateTACJointTarget(e,"tacJoint3Target"),"strTACJoint3Error"==t&&updateTACJointError(e,"tacJoint3Target")}function setupCallbacks(){$("#ID_CLEARCLASS").on("mousedown",function(){sendCmd("Cmd:ClearClass")}),$("#ID_CLEARALL").on("mousedown",function(){sendCmd("Cmd:ClearAll")}),$("#ID_TRAIN").on("mousedown",function(){sendCmd("Cmd:Train")}),$("#ID_SAVE").on("mousedown",function(){sendCmd("Cmd:Save")}),$("#ID_BACKUP").on("mousedown",function(){sendCmd("Cmd:Backup")}),$("#ID_SPEEDUP").on("mousedown",function(){sendCmd("Cmd:SpeedUp")}),$("#ID_SPEEDDOWN").on("mousedown",function(){sendCmd("Cmd:SpeedDown")}),$("#ID_HAND_SPEED_UP").on("mousedown",function(){sendCmd("Cmd:HandSpeedUp")}),$("#ID_HAND_SPEED_DOWN").on("mousedown",function(){sendCmd("Cmd:HandSpeedDown")}),$("#ID_MYO1").on("mousedown",function(){sendCmd("Cmd:RestartMyo1")}),$("#ID_MYO2").on("mousedown",function(){sendCmd("Cmd:RestartMyo2")}),$("#ID_SELECT_MYO_SET_1").on("mousedown",function(){sendCmd("Cmd:ChangeMyoSet1")}),$("#ID_SELECT_MYO_SET_2").on("mousedown",function(){sendCmd("Cmd:ChangeMyoSet2")}),$("#ID_RELOAD_ROC").on("mousedown",function(){sendCmd("Cmd:ReloadRoc")}),$("#ID_REBOOT").on("mousedown",function(){sendCmd("Cmd:Reboot")}),$("#ID_SHUTDOWN").on("mousedown",function(){sendCmd("Cmd:Shutdown")}),$("#ID_ASSESSMENT_MT").on("mousedown",function(){startMT()}),$("#ID_ASSESSMENT_MT_STOP").on("mousedown",function(){stopMT()}),$("#ID_ASSESSMENT_TAC1").on("mousedown",function(){startTAC1()}),$("#ID_ASSESSMENT_TAC3").on("mousedown",function(){startTAC3()}),$("#ID_ASSESSMENT_TAC_STOP").on("mousedown",function(){stopTAC()}),$("#ID_GOTO_HOME").on("mousedown",function(){sendCmd("Cmd:GotoHome")}),$("#ID_GOTO_PARK").on("mousedown",function(){sendCmd("Cmd:GotoPark")}),$("#trainSwitch").on("change",function(){sendCmd(!0===this.checked?"Cmd:Add":"Cmd:Stop")}),$("#precisionMode").on("change",function(){sendCmd(!0===this.checked?"Cmd:PrecisionModeOn":"Cmd:PrecisionModeOff")}),$("#pauseAll").on("change",function(){sendCmd(!0===this.checked?"Cmd:PauseAllOn":"Cmd:PauseAllOff")}),$("#pauseHand").on("change",function(){sendCmd(!0===this.checked?"Cmd:PauseHandOn":"Cmd:PauseHandOff")}),$("#resetTorque").on("change",function(){sendCmd("On"==this.value?"Cmd:ResetTorqueOn":"Cmd:ResetTorqueOff")}),$("#enableImpedance").on("change",function(){sendCmd("On"==this.value?"Cmd:ImpedanceOn":"Cmd:ImpedanceOff")}),$("#impedanceLevel").on("change",function(){sendCmd("Low"==this.value?"Cmd:ImpedanceLow":"Cmd:ImpedanceHigh")}),$("#autoSave").on("change",function(){sendCmd("On"==this.value?"Cmd:AutoSaveOn":"Cmd:AutoSaveOff")})}function submitLogMessage(){var t=document.getElementById("ID_LOG_MSG").value;console.log("Logging "+t),sendCmd("Log:"+t)}function startMT(){sendCmd("Cmd:StartMotionTester-"+$("#ID_MT_REPETITIONS").val()+"-"+$("#ID_MT_TIMEOUT").val()+"-"+$("#ID_MT_MAX_CLASSIFICATIONS").val())}function stopMT(){sendCmd("Cmd:StopMotionTester")}function startTAC1(){sendCmd("Cmd:StartTAC1-"+$("#ID_REPETITIONS").val()+"-"+$("#ID_TIMEOUT").val()+"-"+$("#ID_DWELL_TIME").val()+"-"+$("#ID_DEGREE_ERROR").val()+"-"+$("#ID_GRASP_ERROR").val())}function startTAC3(){sendCmd("Cmd:StartTAC3-"+$("#ID_REPETITIONS").val()+"-"+$("#ID_TIMEOUT").val()+"-"+$("#ID_DWELL_TIME").val()+"-"+$("#ID_DEGREE_ERROR").val()+"-"+$("#ID_GRASP_ERROR").val())}function stopTAC(){sendCmd("Cmd:StopTAC")}function updateMTProgressBar(t){document.getElementById("mtProgressBar").style.width=t+"%",document.getElementById("mtProgressLabel").innerHTML=1*t+"%"}function updateMTImage(t){document.getElementById("ID_MT_IMAGE").src=t}function updateTACJointBar(t,e,n){document.getElementById(e).style.marginLeft=t-2.5+"%",document.getElementById(n).innerHTML=Math.round(1*t)}function updateTACJointError(t,e){document.getElementById(e).style.width=2*t+"%"}function updateTACJointTarget(t,e){var n=document.getElementById(e);percentChar=n.style.width,percentNum=percentChar.substring(0,percentChar.length-1),halfWidth=1*percentNum/2,valuePercent=1*t,newMargin=valuePercent-halfWidth,newMarginPercent=1*newMargin+"%",n.style.marginLeft=newMarginPercent}var socket;jQuery(function(t){"WebSocket"in window?setupWebsockets():alert("Your browser does not support web sockets");setInterval(function(){"up"===Offline.state&&Offline.check()},3e3),Offline.on("up",setupWebsockets)});