var global_motion_class_data=[];function readCsv(t){for(var e=t.split(/\r\n|\n/),n=[],m=0;m<e.length;m++){var o=e[m];if(!("#"==o[0]|o.length<1)){var d=o.split(",");if(0!=n.length){if(d.length==n.length){var a=d[0],s=d[1];global_motion_class_data.push({title:a,href:s,type:"image/"+s.split(".").pop(),thumbnail:s})}}else n=d}}setupGalley(),setupCallbacks()}function routeMessage(t,e){var n;("sys_status"==t&&($("#msg_status").html(e),$("#msg_status_opt").html(e),$("#msg_status_myo").html(e)),"training_class"==t&&$("#msg_train").text(e),"output_class"==t&&($("#main_output").text(e),$("#mt_output").text(e),$("#tac_output").text(e)),"motion_test_status"==t&&$("#mt_status").html(e),"motion_test_update"==t&&updateMTProgressBar(e),"motion_test_setup"==t&&updateMTImage(e),"TAC_status"==t&&$("#tac_status").text(e),"TAC_setup"==t)&&((n=e.split(","))[0]>0&&($("#tacJoint1Name").text(n[1]),updateTACJointTarget(n[2],"tacJoint1Target"),updateTACJointError(n[3],"tacJoint1Target")),n[0]>1&&($("#tacJoint2Name").text(n[4]),updateTACJointTarget(n[5],"tacJoint2Target"),updateTACJointError(n[6],"tacJoint2Target")),n[0]>2&&($("#tacJoint3Name").text(n[7]),updateTACJointTarget(n[8],"tacJoint3Target"),updateTACJointError(n[9],"tacJoint3Target")));"TAC_update"==t&&((n=e.split(","))[0]>0&&updateTACJointBar(n[1],"tacJoint1Bar","tacJoint1Label"),n[0]>1&&updateTACJointBar(n[2],"tacJoint2Bar","tacJoint2Label"),n[0]>2&&updateTACJointBar(n[3],"tacJoint3Bar","tacJoint3Label"));if("joint_cmd"==t){var m=e.split(",");$("#SHFE_Cmd").html(m[0]),$("#SHAA_Cmd").html(m[1]),$("#HUM_Cmd").html(m[2]),$("#EL_Cmd").html(m[3]),$("#WRT_Cmd").html(m[4]),$("#WAA_Cmd").html(m[5]),$("#WFE_Cmd").html(m[6]),$("#1AA_Cmd").html(m[7]),$("#1MCP_Cmd").html(m[8]),$("#1PIP_Cmd").html(m[9]),$("#1DIP_Cmd").html(m[10]),$("#2AA_Cmd").html(m[11]),$("#2MCP_Cmd").html(m[12]),$("#2PIP_Cmd").html(m[13]),$("#2DIP_Cmd").html(m[14]),$("#3AA_Cmd").html(m[15]),$("#3MCP_Cmd").html(m[16]),$("#3PIP_Cmd").html(m[17]),$("#3DIP_Cmd").html(m[18]),$("#4AA_Cmd").html(m[19]),$("#4MCP_Cmd").html(m[20]),$("#4PIP_Cmd").html(m[21]),$("#4DIP_Cmd").html(m[22]),$("#5AA_Cmd").html(m[23]),$("#5CMC_Cmd").html(m[24]),$("#5MCP_Cmd").html(m[25]),$("#5DIP_Cmd").html(m[26])}if("joint_pos"==t){m=e.split(",");$("#SHFE_Pos").html(m[0]),$("#SHAA_Pos").html(m[1]),$("#HUM_Pos").html(m[2]),$("#EL_Pos").html(m[3]),$("#WRT_Pos").html(m[4]),$("#WAA_Pos").html(m[5]),$("#WFE_Pos").html(m[6]),$("#1AA_Pos").html(m[7]),$("#1MCP_Pos").html(m[8]),$("#1PIP_Pos").html(m[9]),$("#1DIP_Pos").html(m[10]),$("#2AA_Pos").html(m[11]),$("#2MCP_Pos").html(m[12]),$("#2PIP_Pos").html(m[13]),$("#2DIP_Pos").html(m[14]),$("#3AA_Pos").html(m[15]),$("#3MCP_Pos").html(m[16]),$("#3PIP_Pos").html(m[17]),$("#3DIP_Pos").html(m[18]),$("#4AA_Pos").html(m[19]),$("#4MCP_Pos").html(m[20]),$("#4PIP_Pos").html(m[21]),$("#4DIP_Pos").html(m[22]),$("#5AA_Pos").html(m[23]),$("#5CMC_Pos").html(m[24]),$("#5MCP_Pos").html(m[25]),$("#5DIP_Pos").html(m[26])}if("joint_torque"==t){m=e.split(",");$("#SHFE_Torque").html(m[0]),$("#SHAA_Torque").html(m[1]),$("#HUM_Torque").html(m[2]),$("#EL_Torque").html(m[3]),$("#WRT_Torque").html(m[4]),$("#WAA_Torque").html(m[5]),$("#WFE_Torque").html(m[6]),$("#1AA_Torque").html(m[7]),$("#1MCP_Torque").html(m[8]),$("#1PIP_Torque").html(m[9]),$("#1DIP_Torque").html(m[10]),$("#2AA_Torque").html(m[11]),$("#2MCP_Torque").html(m[12]),$("#2PIP_Torque").html(m[13]),$("#2DIP_Torque").html(m[14]),$("#3AA_Torque").html(m[15]),$("#3MCP_Torque").html(m[16]),$("#3PIP_Torque").html(m[17]),$("#3DIP_Torque").html(m[18]),$("#4AA_Torque").html(m[19]),$("#4MCP_Torque").html(m[20]),$("#4PIP_Torque").html(m[21]),$("#4DIP_Torque").html(m[22]),$("#5AA_Torque").html(m[23]),$("#5CMC_Torque").html(m[24]),$("#5MCP_Torque").html(m[25]),$("#5DIP_Torque").html(m[26])}if("joint_temp"==t){m=e.split(",");$("#SHFE_Temp").html(m[0]),$("#SHAA_Temp").html(m[1]),$("#HUM_Temp").html(m[2]),$("#EL_Temp").html(m[3]),$("#WRT_Temp").html(m[4]),$("#WAA_Temp").html(m[5]),$("#WFE_Temp").html(m[6]),$("#1AA_Temp").html(m[7]),$("#1MCP_Temp").html(m[8]),$("#1PIP_Temp").html(m[9]),$("#1DIP_Temp").html(m[10]),$("#2AA_Temp").html(m[11]),$("#2MCP_Temp").html(m[12]),$("#2PIP_Temp").html(m[13]),$("#2DIP_Temp").html(m[14]),$("#3AA_Temp").html(m[15]),$("#3MCP_Temp").html(m[16]),$("#3PIP_Temp").html(m[17]),$("#3DIP_Temp").html(m[18]),$("#4AA_Temp").html(m[19]),$("#4MCP_Temp").html(m[20]),$("#4PIP_Temp").html(m[21]),$("#4DIP_Temp").html(m[22]),$("#5AA_Temp").html(m[23]),$("#5CMC_Temp").html(m[24]),$("#5MCP_Temp").html(m[25]),$("#5DIP_Temp").html(m[26])}}function setupCallbacks(){$("#ID_CLEARCLASS").on("mousedown",function(){sendCmd("Cmd:ClearClass")}),$("#ID_CLEARALL").on("mousedown",function(){sendCmd("Cmd:ClearAll")}),$("#ID_TRAIN").on("mousedown",function(){sendCmd("Cmd:Train")}),$("#ID_SAVE").on("mousedown",function(){sendCmd("Cmd:Save")}),$("#ID_BACKUP").on("mousedown",function(){sendCmd("Cmd:Backup")}),$("#ID_SPEEDUP").on("mousedown",function(){sendCmd("Cmd:SpeedUp")}),$("#ID_SPEEDDOWN").on("mousedown",function(){sendCmd("Cmd:SpeedDown")}),$("#ID_HAND_SPEED_UP").on("mousedown",function(){sendCmd("Cmd:HandSpeedUp")}),$("#ID_HAND_SPEED_DOWN").on("mousedown",function(){sendCmd("Cmd:HandSpeedDown")}),$("#ID_MYO1").on("mousedown",function(){sendCmd("Cmd:RestartMyo1")}),$("#ID_MYO2").on("mousedown",function(){sendCmd("Cmd:RestartMyo2")}),$("#ID_SELECT_MYO_SET_1").on("mousedown",function(){sendCmd("Cmd:ChangeMyoSet1")}),$("#ID_SELECT_MYO_SET_2").on("mousedown",function(){sendCmd("Cmd:ChangeMyoSet2")}),$("#ID_RELOAD_ROC").on("mousedown",function(){sendCmd("Cmd:ReloadRoc")}),$("#ID_REBOOT").on("mousedown",function(){sendCmd("Cmd:Reboot")}),$("#ID_SHUTDOWN").on("mousedown",function(){sendCmd("Cmd:Shutdown")}),$("#ID_ASSESSMENT_MT").on("mousedown",function(){startMT()}),$("#ID_ASSESSMENT_MT_STOP").on("mousedown",function(){stopMT()}),$("#ID_ASSESSMENT_TAC1").on("mousedown",function(){startTAC1()}),$("#ID_ASSESSMENT_TAC3").on("mousedown",function(){startTAC3()}),$("#ID_ASSESSMENT_TAC_STOP").on("mousedown",function(){stopTAC()}),$("#ID_GOTO_HOME").on("mousedown",function(){sendCmd("Cmd:GotoHome")}),$("#ID_GOTO_PARK").on("mousedown",function(){sendCmd("Cmd:GotoPark")});var t=[],e=[],n=[];t+='<a href="#" class="ui-btn" id="MAN_Stop1">Stop</a>';for(var m=0,o=0;o<global_motion_class_data.length;o++)if(id="MAN_"+global_motion_class_data[o].title.replace(/ /g,"_"),name=global_motion_class_data[o].title,"No Movement"!=name){for(var d=0;e.includes(id);)id+=(d+=1).toString();e.push(id),n.push(name),"Hand Open"!=global_motion_class_data[o].title?0==m?(t+='<fieldset class="ui-grid-a">',t+='<div class="ui-block-a"><a href="#" class="ui-btn" id="'+id+'">'+name+"</a></div>",m+=1):(t+='<div class="ui-block-b"><a href="#" class="ui-btn" id="'+id+'">'+name+"</a></div>",t+="</fieldset>",m=0):t+='<a href="#" class="ui-btn" id="'+id+'">'+name+"</a>"}t+='<a href="#" class="ui-btn" id="MAN_Stop2">Stop</a>';var a=document.getElementById("ID_MANUAL_CONTROL"),s=document.createElement("div");s.innerHTML=t,a.appendChild(s);for(o=0;o<e.length;o++)$("#"+e[o]).mousedown("Man:"+n[o],function(t){sendCmd(t.data)});$("#MAN_Stop1").on("mousedown",function(){sendCmd("Man:Stop")}),$("#MAN_Stop2").on("mousedown",function(){sendCmd("Man:Stop")}),$("#trainSwitch").on("change",function(){!0===this.checked?sendCmd("Cmd:Add"):sendCmd("Cmd:Stop")}),$("#precisionMode").on("change",function(){!0===this.checked?sendCmd("Cmd:PrecisionModeOn"):sendCmd("Cmd:PrecisionModeOff")}),$("#pauseAll").on("change",function(){!0===this.checked?sendCmd("Cmd:PauseAllOn"):sendCmd("Cmd:PauseAllOff")}),$("#pauseHand").on("change",function(){!0===this.checked?sendCmd("Cmd:PauseHandOn"):sendCmd("Cmd:PauseHandOff")}),$("#resetTorque").on("change",function(){"On"==this.value?sendCmd("Cmd:ResetTorqueOn"):sendCmd("Cmd:ResetTorqueOff")}),$("#enableImpedance").on("change",function(){"On"==this.value?sendCmd("Cmd:ImpedanceOn"):sendCmd("Cmd:ImpedanceOff")}),$("#impedanceLevel").on("change",function(){"Low"==this.value?sendCmd("Cmd:ImpedanceLow"):sendCmd("Cmd:ImpedanceHigh")}),$("#autoSave").on("change",function(){"On"==this.value?sendCmd("Cmd:AutoSaveOn"):sendCmd("Cmd:AutoSaveOff")}),$("#autoOpen").on("change",function(){"On"==this.value?sendCmd("Cmd:AutoOpenOn"):sendCmd("Cmd:AutoOpenOff")}),$("#manualControl").on("change",function(){"On"==this.value?sendCmd("Cmd:ManualControlOn"):sendCmd("Cmd:ManualControlOff")}),$("#streamPercepts").on("change",function(){"On"==this.value?sendCmd("Cmd:JointPerceptsOn"):sendCmd("Cmd:JointPerceptsOff")})}function submitLogMessage(){var t=document.getElementById("ID_LOG_MSG").value;console.log("Logging "+t),sendCmd("Log:"+t)}function startMT(){var t=$("#ID_MT_REPETITIONS").val(),e=$("#ID_MT_TIMEOUT").val(),n=$("#ID_MT_MAX_CLASSIFICATIONS").val();sendCmd("Cmd:StartMotionTester-"+t+"-"+e+"-"+n)}function stopMT(){sendCmd("Cmd:StopMotionTester")}function startTAC1(){var t=$("#ID_REPETITIONS").val(),e=$("#ID_TIMEOUT").val(),n=$("#ID_DWELL_TIME").val(),m=$("#ID_DEGREE_ERROR").val(),o=$("#ID_GRASP_ERROR").val();sendCmd("Cmd:StartTAC1-"+t+"-"+e+"-"+n+"-"+m+"-"+o)}function startTAC3(){var t=$("#ID_REPETITIONS").val(),e=$("#ID_TIMEOUT").val(),n=$("#ID_DWELL_TIME").val(),m=$("#ID_DEGREE_ERROR").val(),o=$("#ID_GRASP_ERROR").val();sendCmd("Cmd:StartTAC3-"+t+"-"+e+"-"+n+"-"+m+"-"+o)}function stopTAC(){sendCmd("Cmd:StopTAC")}function updateMTProgressBar(t){document.getElementById("mtProgressBar").style.width=t+"%",document.getElementById("mtProgressLabel").innerHTML=1*t+"%"}function updateMTImage(t){document.getElementById("ID_MT_IMAGE").src=t}function updateTACJointBar(t,e,n){document.getElementById(e).style.marginLeft=t-2.5+"%",document.getElementById(n).innerHTML=Math.round(1*t)}function updateTACJointError(t,e){document.getElementById(e).style.width=2*t+"%"}function updateTACJointTarget(t,e){var n=document.getElementById(e);percentChar=n.style.width,percentNum=percentChar.substring(0,percentChar.length-1),halfWidth=1*percentNum/2,valuePercent=1*t,newMargin=valuePercent-halfWidth,newMarginPercent=1*newMargin+"%",n.style.marginLeft=newMarginPercent}$(function(){jQuery.ajax({type:"GET",dataType:"text",url:"./motion_name_image_map.csv",success:function(t){readCsv(t)}})});