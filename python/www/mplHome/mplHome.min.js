function setupWebsockets(){var e="ws://"+document.location.hostname+":9090/ws";console.log(e),socket=new WebSocket(e),console.log("socket status: "+socket.readyState),socket?(socket.onmessage=function(e){value=e.data,console.log("[onStringMessage] new message received ",value);var t=value.indexOf(":"),n=value.slice(0,t),o=value.slice(t+1);routeMessage(n,o)},socket.onclose=function(){console.log("The connection has been closed."),socket.close}):console.log("invalid socket"),setupCallbacks()}function sendCmd(e){console.log("SEND:"+e),socket.send(e)}function routeMessage(e,t){"strStatus"==e&&($("#msg_status").html(t),$("#msg_status_opt").html(t),$("#msg_status_myo").html(t)),"strTrainingMotion"==e&&$("#msg_train").text(t),"strOutputMotion"==e&&($("#main_output").text(t),$("#mt_output").text(t),$("#tac_output").text(t)),"strMotionTester"==e&&$("#mt_status").text(t),"strMotionTesterProgress"==e&&updateMTProgressBar(t),"strMotionTesterImage"==e&&updateMTImage(t),"strTAC"==e&&$("#tac_status").text(t),"strTACJoint1Name"==e&&$("#tacJoint1Name").text(t),"strTACJoint1Bar"==e&&updateTACJointBar(t,"tacJoint1Bar","tacJoint1Label"),"strTACJoint1Target"==e&&updateTACJointTarget(t,"tacJoint1Target"),"strTACJoint1Error"==e&&updateTACJointError(t,"tacJoint1Target"),"strTACJoint2Name"==e&&$("#tacJoint2Name").text(t),"strTACJoint2Bar"==e&&updateTACJointBar(t,"tacJoint2Bar","tacJoint2Label"),"strTACJoint2Target"==e&&updateTACJointTarget(t,"tacJoint2Target"),"strTACJoint2Error"==e&&updateTACJointError(t,"tacJoint2Target"),"strTACJoint3Name"==e&&$("#tacJoint3Name").text(t),"strTACJoint3Bar"==e&&updateTACJointBar(t,"tacJoint3Bar","tacJoint3Label"),"strTACJoint3Target"==e&&updateTACJointTarget(t,"tacJoint3Target"),"strTACJoint3Error"==e&&updateTACJointError(t,"tacJoint3Target")}function setupCallbacks(){$("#ID_CLEARCLASS").on("mousedown",function(){sendCmd("Cmd:ClearClass")}),$("#ID_CLEARALL").on("mousedown",function(){sendCmd("Cmd:ClearAll")}),$("#ID_TRAIN").on("mousedown",function(){sendCmd("Cmd:Train")}),$("#ID_SAVE").on("mousedown",function(){sendCmd("Cmd:Save")}),$("#ID_BACKUP").on("mousedown",function(){sendCmd("Cmd:Backup")}),$("#ID_SPEEDUP").on("mousedown",function(){sendCmd("Cmd:SpeedUp")}),$("#ID_SPEEDDOWN").on("mousedown",function(){sendCmd("Cmd:SpeedDown")}),$("#ID_HAND_SPEED_UP").on("mousedown",function(){sendCmd("Cmd:HandSpeedUp")}),$("#ID_HAND_SPEED_DOWN").on("mousedown",function(){sendCmd("Cmd:HandSpeedDown")}),$("#ID_MYO1").on("mousedown",function(){sendCmd("Cmd:RestartMyo1")}),$("#ID_MYO2").on("mousedown",function(){sendCmd("Cmd:RestartMyo2")}),$("#ID_SELECT_MYO_SET_1").on("mousedown",function(){sendCmd("Cmd:ChangeMyoSet1")}),$("#ID_SELECT_MYO_SET_2").on("mousedown",function(){sendCmd("Cmd:ChangeMyoSet2")}),$("#ID_RELOAD_ROC").on("mousedown",function(){sendCmd("Cmd:ReloadRoc")}),$("#ID_REBOOT").on("mousedown",function(){sendCmd("Cmd:Reboot")}),$("#ID_SHUTDOWN").on("mousedown",function(){sendCmd("Cmd:Shutdown")}),$("#ID_ASSESSMENT_MT").on("mousedown",function(){startMT()}),$("#ID_ASSESSMENT_TAC1").on("mousedown",function(){startTAC1()}),$("#ID_ASSESSMENT_TAC3").on("mousedown",function(){startTAC3()}),$("#ID_GOTO_HOME").on("mousedown",function(){sendCmd("Cmd:GotoHome")}),$("#ID_GOTO_PARK").on("mousedown",function(){sendCmd("Cmd:GotoPark")}),$("#trainSwitch").on("change",function(){sendCmd(this.checked===!0?"Cmd:Add":"Cmd:Stop")}),$("#precisionMode").on("change",function(){sendCmd(this.checked===!0?"Cmd:PrecisionModeOn":"Cmd:PrecisionModeOff")}),$("#pauseAll").on("change",function(){sendCmd(this.checked===!0?"Cmd:PauseAllOn":"Cmd:PauseAllOff")}),$("#pauseHand").on("change",function(){sendCmd(this.checked===!0?"Cmd:PauseHandOn":"Cmd:PauseHandOff")}),$("#resetTorque").on("change",function(){sendCmd("On"==this.value?"Cmd:ResetTorqueOn":"Cmd:ResetTorqueOff")}),$("#enableImpedance").on("change",function(){sendCmd("On"==this.value?"Cmd:ImpedanceOn":"Cmd:ImpedanceOff")}),$("#impedanceLevel").on("change",function(){sendCmd("Low"==this.value?"Cmd:ImpedanceLow":"Cmd:ImpedanceHigh")}),$("#autoSave").on("change",function(){sendCmd("On"==this.value?"Cmd:AutoSaveOn":"Cmd:AutoSaveOff")})}function submitLogMessage(){var e=document.getElementById("ID_LOG_MSG").value;console.log("Logging "+e),sendCmd("Log:"+e)}function startMT(){var e=$("#ID_MT_REPETITIONS").val(),t=$("#ID_MT_TIMEOUT").val(),n=$("#ID_MT_MAX_CLASSIFICATIONS").val();sendCmd("Cmd:StartMotionTester-"+e+"-"+t+"-"+n)}function startTAC1(){var e=$("#ID_REPETITIONS").val(),t=$("#ID_TIMEOUT").val(),n=$("#ID_DWELL_TIME").val(),o=$("#ID_DEGREE_ERROR").val(),a=$("#ID_GRASP_ERROR").val();sendCmd("Cmd:StartTAC1-"+e+"-"+t+"-"+n+"-"+o+"-"+a)}function startTAC3(){var e=$("#ID_REPETITIONS").val(),t=$("#ID_TIMEOUT").val(),n=$("#ID_DWELL_TIME").val(),o=$("#ID_DEGREE_ERROR").val(),a=$("#ID_GRASP_ERROR").val();sendCmd("Cmd:StartTAC3-"+e+"-"+t+"-"+n+"-"+o+"-"+a)}function updateMTProgressBar(e){var t=document.getElementById("mtProgressBar");t.style.width=e+"%",document.getElementById("mtProgressLabel").innerHTML=1*e+"%"}function updateMTImage(e){document.getElementById("ID_MT_IMAGE").src=e}function updateTACJointBar(e,t,n){var o=document.getElementById(t);o.style.marginLeft=e-2.5+"%",document.getElementById(n).innerHTML=Math.round(1*e)}function updateTACJointError(e,t){var n=document.getElementById(t);n.style.width=2*e+"%"}function updateTACJointTarget(e,t){var n=document.getElementById(t);percentChar=n.style.width,percentNum=percentChar.substring(0,percentChar.length-1),halfWidth=1*percentNum/2,valuePercent=1*e,newMargin=valuePercent-halfWidth,newMarginPercent=1*newMargin+"%",n.style.marginLeft=newMarginPercent}var socket;jQuery(function(e){"WebSocket"in window?setupWebsockets():alert("Your browser does not support web sockets");var t=function(){"up"===Offline.state&&Offline.check()};setInterval(t,3e3),Offline.on("up",setupWebsockets)});